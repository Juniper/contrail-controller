- set_fact:
    job_ctx: "{{job_ctx|combine({'current_task_index': current_index })}}"
    device_name: "{{ prouter_name if prouter_name is defined else '' }}"
    details: "{{ jl_details if jl_details is defined else {} }}"
    message: "{{ jl_message }}"

#- name: "Call joblog to update percentage"
#  job_objectlog:
#    job_ctx: "{{ job_ctx }}"
#    status: "{{ JOBLOG_STATUS.IN_PROGRESS }}"
#    message: "{{ jl_message }}"
#    device_name: "{{ prouter_name if prouter_name is defined else '' }}"
#    details: "{{ jl_details if jl_details is defined else {} }}"
#  register: jl_output


- set_fact:
    job_log_info: "{{ job_log_info|default({}) | combine ({ 'device_name': device_name, 'details': details, 'message': message }) }}"

- name: insert/update in /tmp/<exec-id> file
  set_fact:
    write_resp: "{{job_ctx | job_log_percentage_completion(job_log_info)}}"
