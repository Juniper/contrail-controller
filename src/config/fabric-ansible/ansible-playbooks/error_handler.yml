- set_fact:
    output: {
       "status": "Failure",
       "message": "{{op_err_message}}",
       "results": "{{results}}"
    }

- name: print output
  debug: var=output verbosity=1

#- name: "Append job log for the error"
#  job_objectlog:
#    job_ctx: "{{ job_ctx }}"
#    status: "{{ JOBLOG_STATUS.IN_PROGRESS }}"
#    message: "{{ jl_err_message }}"
#    device_name: "{{ prouter_name if prouter_name is defined else '' }}"
#    details: "{{ jl_details if jl_details is defined else {} }}"

- set_fact:
    device_name: "{{ prouter_name if prouter_name is defined else '' }}"
    message: "{{ jl_err_message }}"
    details: "{{ jl_details if jl_details is defined else {} }}"

- set_fact:
    job_log_info: "{{ job_log_info|default({}) | combine ({
    'device_name': device_name, 'details': details, 'message': message }) }}"

- name: insert/update in /tmp/<exec-id> file
  set_fact:
    write_resp: "{{job_ctx | job_log_percentage_completion(job_log_info)}}"

- meta: end_play
